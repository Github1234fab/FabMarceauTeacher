<script>
    let Nom = "";
    let Email = "";
    let Demande = "";
    let T√©l√©phone = "";
    let message = ""; // Message de confirmation ou d'erreur
  
    const sheetUrl = "https://script.google.com/macros/s/AKfycbxawIP7hChV6KuWiueMfBlBC67E-UDNKoa2v5ybyhrnaOSFzktW7GbaeBtGtc-Uha8Ysg/exec";
  
    // Fonction pour soumettre le formulaire
    async function submitForm() {
  // Test d'acc√®s √† l'API
  await fetch(sheetUrl, { method: "GET", mode: "no-cors" });

  // Envoi des donn√©es
  const response = await fetch(sheetUrl, {
    method: "POST",
    mode: "no-cors", // üî¥ Permet d‚Äô√©viter l‚Äôerreur mais emp√™che de lire la r√©ponse
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ Nom, Email, Demande, T√©l√©phone }),
  });

  console.log("Formulaire soumis !");
}
  </script>
  
  <form on:submit|preventDefault={submitForm}>
    <label for="Nom">Nom:</label>
    <input id="Nom" type="text" bind:value={Nom} required />
  
    <label for="Email">Email:</label>
    <input id="Email" type="email" bind:value={Email} required />
  
    <label for="Demande">Demande:</label>
    <textarea id="Demande" bind:value={Demande} required></textarea>
  
    <label for="T√©l√©phone">T√©l√©phone:</label>
    <input id="T√©l√©phone" type="tel" bind:value={T√©l√©phone} />
  
    <button type="submit">Soumettre</button>
  </form>
  
  {#if message}
    <p>{message}</p>
  {/if}
  